{% extends "base.html" %}

{% block title %}Dashboard Recepcionista - Hotel Paradise{% endblock %}

{% block content %}
<style>
.sidebar { background: #f8f9fa; }
.card-dashboard { border-radius: 10px; }
.card .card-header { border-top-left-radius: 10px; border-top-right-radius: 10px; }
</style>

<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <div class="col-md-3 col-lg-2 sidebar bg-light min-vh-100 border-end">
      <div class="py-4 px-3">
        <h5 class="text-primary fw-bold mb-4">
          <i class="fas fa-user-tie me-2"></i>Recepcionista
        </h5>
        <nav class="nav flex-column">
          <a class="nav-link active mb-1" href="{{ url_for('receptionist.dashboard') }}">
            <i class="fas fa-tachometer-alt me-2"></i>Dashboard
          </a>
          <a class="nav-link mb-1" href="{{ url_for('receptionist.rooms') }}">
            <i class="fas fa-bed me-2"></i>Habitaciones
          </a>
          <a class="nav-link mb-1" href="{{ url_for('receptionist.reservations') }}">
            <i class="fas fa-calendar-alt me-2"></i>Reservaciones
          </a>
          <a class="nav-link mb-1" href="{{ url_for('receptionist.payments') }}">
            <i class="fas fa-credit-card me-2"></i>Pagos
          </a>
        </nav>
      </div>
    </div>

    <!-- Main -->
    <div class="col-md-9 col-lg-10">
      <div class="py-4 px-4">
        <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
          <h1 class="h3 text-primary fw-bold">Dashboard Recepcionista</h1>
          <div class="text-muted small">
            <span>{{ current_time.strftime('%d/%m/%Y %H:%M') }}</span> |
            Bienvenido, <strong>{{ current_user.get_full_name() }}</strong>
          </div>
        </div>

        <!-- Quick Stats -->
        <div class="row g-4 mb-5">
          <div class="col-md-3">
            <div class="card shadow-sm card-dashboard h-100">
              <div class="card-body text-center">
                <i class="fas fa-door-open fa-2x text-success mb-3"></i>
                <div class="h2">{{ available_rooms }}</div>
                <p class="mb-0 text-muted">Disponibles</p>
              </div>
            </div>
          </div>

          <div class="col-md-3">
            <div class="card shadow-sm card-dashboard h-100">
              <div class="card-body text-center">
                <i class="fas fa-door-closed fa-2x text-danger mb-3"></i>
                <div class="h2">{{ occupied_rooms }}</div>
                <p class="mb-0 text-muted">Ocupadas</p>
              </div>
            </div>
          </div>

          <div class="col-md-3">
            <div class="card shadow-sm card-dashboard h-100">
              <div class="card-body text-center">
                <i class="fas fa-clock fa-2x text-warning mb-3"></i>
                <div class="h2">{{ todays_checkins|length }}</div>
                <p class="mb-0 text-muted">Check-ins Pendientes</p>
              </div>
            </div>
          </div>

          <div class="col-md-3">
            <div class="card shadow-sm card-dashboard h-100">
              <div class="card-body text-center">
                <i class="fas fa-calendar-check fa-2x text-primary mb-3"></i>
                <div class="h2">{{ todays_checkouts|length }}</div>
                <p class="mb-0 text-muted">Check-outs Hoy</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Actions + Gráfico -->
        <div class="row g-4">
          <!-- Quick Actions -->
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-bolt me-2"></i>Acciones Rápidas</h5>
              </div>
              <div class="card-body">
                <div class="row g-2">
                  <div class="col-6 mb-2">
                    <a href="{{ url_for('receptionist.new_reservation') }}" class="btn btn-success w-100 py-2">
                      <i class="fas fa-plus-circle me-2"></i>Nueva Reserva
                    </a>
                  </div>
                  <div class="col-6 mb-2">
                    <a href="{{ url_for('receptionist.rooms') }}" class="btn btn-info w-100 py-2">
                      <i class="fas fa-bed me-2"></i>Ver Habitaciones
                    </a>
                  </div>
                  <div class="col-6 mb-2">
                    <a href="{{ url_for('receptionist.reservations') }}" class="btn btn-primary w-100 py-2">
                      <i class="fas fa-calendar-alt me-2"></i>Reservaciones
                    </a>
                  </div>
                  <div class="col-6 mb-2">
                    <a href="{{ url_for('receptionist.payments') }}" class="btn btn-secondary w-100 py-2">
                      <i class="fas fa-credit-card me-2"></i>Pagos
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Gráfico -->
          <div class="col-md-6">
            <div class="card shadow-sm h-100">
              <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Estadísticas</h5>
              </div>
              <div class="card-body">
                <canvas id="dashboardChart" width="400" height="250"></canvas>
              </div>
            </div>
          </div>
        </div> <!-- row -->
      </div> <!-- px-4 -->
    </div> <!-- col -->
  </div> <!-- row -->
</div> <!-- container -->

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('dashboardChart').getContext('2d');
const dashboardChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ['Disponibles', 'Ocupadas', 'Check-ins', 'Check-outs'],
        datasets: [{
            label: 'Cantidad',
            data: [
                {{ available_rooms }},
                {{ occupied_rooms }},
                {{ todays_checkins|length }},
                {{ todays_checkouts|length }}
            ],
            backgroundColor: [
                'rgba(40, 167, 69, 0.7)',
                'rgba(220, 53, 69, 0.7)',
                'rgba(255, 193, 7, 0.7)',
                'rgba(13, 110, 253, 0.7)'
            ],
            borderColor: [
                'rgba(40, 167, 69, 1)',
                'rgba(220, 53, 69, 1)',
                'rgba(255, 193, 7, 1)',
                'rgba(13, 110, 253, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { display: false },
            tooltip: { enabled: true }
        },
        scales: {
            y: {
                beginAtZero: true,
                stepSize: 1
            }
        }
    }
});
</script>
{% endblock %}
